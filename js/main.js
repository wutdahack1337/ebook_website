let signupform=document.getElementById("signupform");function Signup(){let username=document.getElementById("username");let password=document.getElementById("password");let email=document.getElementById("email");let emailReg=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;if(emailReg.test(email.value)==false){alert("Hãy nhập chính xác email của bạn");return false}if(username.value.length==0){alert("Không được bỏ trống username");return false}if(typeof localStorage[username.value]!=="undefined"){alert("Vui lòng đặt username khác");return false}if(password.value.length==0){alert("Không được bỏ trống password");return false}window.localStorage.setItem(username.value,password.value);alert("Tạo tài khoản thành công.");return true}function Checkaccount(){let username=document.getElementById("username");let password=document.getElementById("password");if(typeof localStorage[username.value]!=="undefined"&&window.localStorage.getItem(username.value)==password.value){alert("Đăng nhập thành công, chào mừng "+username.value);window.localStorage.setItem("loginsuccesful",username.value);return true}alert("Vui lòng nhập chính xác username và password");return false}function Logout(){window.localStorage.removeItem("loginsuccesful");alert("Đăng xuất thành công...")}if(typeof localStorage["loginsuccesful"]!=="undefined"&&window.localStorage.getItem("loginsuccesful")!=0){let login=document.getElementById("login");let signup=document.getElementById("signup");login.remove();signup.remove();let nav=document.querySelector("nav");let cart=document.createElement("a");cart.href="./giohang.html";cart.innerHTML="Giỏ hàng";nav.appendChild(cart);let logout=document.createElement("a");logout.href="./trangchu.html";logout.setAttribute("onclick","Logout()");logout.innerHTML="Đăng xuất";nav.appendChild(logout)}let itemlist={sp01:{name:"Kỷ Luật Bản Thân",price:12e4,author:"Peg Dawson, Richard Guare",brief:"Dawson và Guare là những bậc thầy về kỹ năng điều hành. Họ cung cấp cho chúng ta một cuốn sách hướng dẫn dễ đọc, thực tiễn và cực kỳ giá trị.",photo:"./images/sp01.jpg"},sp02:{name:"Cây Cam Ngọt Của Tôi",price:75e3,author:"José Mauro de Vasconcelos",brief:"Hãy làm quen với Zezé, cậu bé tinh nghịch siêu hạng đồng thời cũng đáng yêu bậc nhất, với ước mơ lớn lên trở thành nhà thơ cổ thắt nơ bướm. Chẳng phải ai cũng công nhận khoản “đáng yêu” kia đâu nhé. Bởi vì, ở cái xóm ngoại ô nghèo ấy, nỗi khắc khổ bủa vây đã che mờ mắt người ta trước trái tim thiện lương cùng trí tưởng tượng tuyệt vời của cậu bé con năm tuổi.",photo:"./images/sp02.jpg"},sp03:{name:"Vị Thần Của Những Quyết Định",price:52e3,author:"Universe",brief:"Một cuốn sách tâm linh giúp bạn giải quyết những vấn đề trong cuộc sống, công việc, tình cảm… Nếu bạn đang phân vân trước những lựa chọn, nếu bạn đang thiếu quyết đoán, nếu bạn không biết tiếp theo nên làm gì: hãy đặt một câu hỏi. Và hãy để những vị thần quyết định thay bạn.",photo:"./images/sp03.jpg"},sp04:{name:"Thiên Tài Bên Trái, Kẻ Điên Bên Phải",price:119e3,author:"Cao Minh",brief:"NẾU MỘT NGÀY ANH THẤY TÔI ĐIÊN, THỰC RA CHÍNH LÀ ANH ĐIÊN ĐẤY!",photo:"./images/sp04.jpg"},sp05:{name:"Eloquent JavaScript",price:55e4,author:"Marijn Haverbeke",brief:"Completely revised and updated, this best-selling introduction to programming in JavaScript focuses on writing real applications",photo:"./images/sp05.jpg"},sp06:{name:"HTML, CSS, & JavaScript All-in-One For Dummies",price:669e3,author:"Paul McFedries",brief:"A thorough and helpful reference for aspiring website builders",photo:"./images/sp06.jpg"},sp07:{name:"C Programming Language",price:1363e3,author:"Brian W. Kernighan, Dennis M. Ritchie",brief:"#1 Best Seller in Computer Programming Languages",photo:"./images/sp07.jpg"},sp08:{name:"Learning the bash Shell",price:636e3,author:"Cameron Newham",brief:"Now that Linux is an established player both as a server and on the desktop Learning the bash Shell has been updated and refreshed to account for all the latest changes. Indeed, this third edition serves as the most valuable guide yet to the bash shell.",photo:"./images/sp08.jpg"},sp09:{name:"Programming Python",price:1533e3,author:"Mark Lutz",brief:"If you've mastered Python's fundamentals, you're ready to start using it to get real work done.",photo:"./images/sp09.jpg"},sp10:{name:"One-Punch Man Vol.1 - Chỉ Một Cú Đấm",price:25e3,author:"One, Yusuke Murata",brief:"Một đấm chết luôn! Người hùng Saitama quá mạnh, bất cứ ác nhân hay quái thú nào gặp anh cũng đều bị hạ gục dễ dàng chỉ sau một cú đấm! Truyền thuyết về người hùng lãnh đạm bắt đầu!!",photo:"./images/sp10.jpg"},sp11:{name:"One-Punch Man Vol.2 - Chìa Khóa Sức Mạnh",price:25e3,author:"One, Yusuke Murata",brief:"Bí kíp đã được phơi bày! Genos và Saitama cùng nhau đột nhập Viện tiến hóa, nơi đã gửi thích khách đến ám sát thày trò họ. Tại đố, họ bị hung thần Kabuto - vũ khí tối thượng của viện tấn công như vũ bão. Genos bị thương nặng suýt chết khiến Saitama thực sự nổi giận?",photo:"./images/sp11.jpg"},sp12:{name:"One-Punch Man Vol.3 - Lời Đồn",price:25e3,author:"One, Yusuke Murata",brief:"Con đường trở thành anh hùng chuyên nghiệp đã bắt đầu! Saitama và Genos cùng tham gia bài thi đầu vào của Hiệp hội siêu anh hùng! Ở bài thi thể lực, anh đã khiến tất cả ban giám khảo phải kinh ngạc, nhưng không hiểu sao lại chỉ được xếp hạng anh hùng cấp C!? Vừa gia nhập tổ chức chưa lâu, anh đã phải đối diện với một nguy cơ mới…",photo:"./images/sp12.jpg"}};function Order(){let user=window.localStorage.getItem("loginsuccesful");for(let key in window.localStorage){if(key.startsWith(user+"_")){window.localStorage.removeItem(key)}}alert("Bạn đã đặt hàng thành công. Chúng tôi sẽ gửi ebook cho bạn trong thời gian sớm nhất");location.reload(1)}function Addcart(code){if(window.localStorage.getItem("loginsuccesful")==null){alert("Bạn phải đăng nhập trước");event.preventDefault()}else{let user=window.localStorage.getItem("loginsuccesful");let add_amount=Number(document.getElementById("add_amount").value);if(window.localStorage.getItem(user+"_"+code)==null){window.localStorage.setItem(user+"_"+code,add_amount)}else{let now=Number(window.localStorage.getItem(user+"_"+code));window.localStorage.setItem(user+"_"+code,now+add_amount)}alert("Thêm vào giỏ hàng thành công")}}function Removeproduct(code){window.localStorage.removeItem(code);location.reload(1)}window.onstorage=()=>{location.reload(1)};let cart_container=document.querySelector(".cart_container");if(cart_container!=null){let user=window.localStorage.getItem("loginsuccesful");let cart_container=document.querySelector(".cart_container");let cnt=0;for(let key in window.localStorage){if(key.startsWith(user+"_")){++cnt}}if(cnt==0){cart_container.innerHTML+="<p id='emptycart'>Chưa có sản phẩm nào trong giỏ hàng</p> <div><a class='goback' href='./sanpham.html'><button class='btn' id='gobackbutton'>Tới trang mua hàng</button></a></div>"}else{let cart_container=document.querySelector(".cart_container");let table=document.createElement("table");table.innerHTML+="<thead><tr><th id='thead_product_infor'>Sản phẩm</th><th>Giá</th><th>Số lượng</th><th>Tổng</th><th></th></tr><tr><td colspan='5'><div class='line'></div></td></tr></thead>";let total=0,cnt=0;for(let key in window.localStorage){if(key.startsWith(user+"_sp")){let code=key.slice(-4);let thisrow=document.createElement("tr");let product_infor=document.createElement("td");product_infor.setAttribute("class","product_infor");product_infor.innerHTML+="<div class='product_img'><img class='product_img' src="+itemlist[code].photo+"></div><div class='product_name'>"+itemlist[code].name+"</div>";thisrow.appendChild(product_infor);let product_price=document.createElement("td");let price=itemlist[code].price;product_price.innerHTML+=price.toLocaleString("vi-VN",{style:"currency",currency:"VND"});thisrow.appendChild(product_price);let product_amount=document.createElement("td");let amount=Number(window.localStorage.getItem(key));product_amount.innerHTML+=amount;thisrow.appendChild(product_amount);let product_sum=document.createElement("td");let sum=Number(amount)*Number(price);product_sum.innerHTML+=sum.toLocaleString("vi-VN",{style:"currency",currency:"VND"});thisrow.appendChild(product_sum);let remove=document.createElement("td");remove.setAttribute("class","remove_container");remove.innerHTML+="<button class='btn-close' aria-label='Close' onclick='Removeproduct(this.id)' id='"+key+"'></button>";thisrow.appendChild(remove);table.appendChild(thisrow);total+=sum;cnt+=amount}}table.innerHTML+="<tr><td colspan='5'><div class='line'></div></td></tr>";table.innerHTML+="<tr id='cart_total'><td colspan=2><div><button class='btn' id='gobackbutton' onclick='Order()'>Đặt hàng</button></div></td><td>"+cnt+"</td><td>"+total.toLocaleString("vi-VN",{style:"currency",currency:"VND"})+"</td></tr>";cart_container.appendChild(table)}}function loadDetail(code){window.location="./detail.html";window.localStorage.setItem("productneedload",code)}let detail_container=document.getElementById("detail_container");if(detail_container!=null){let code=window.localStorage.getItem("productneedload");let detail_img=document.querySelector(".detail_img");let img=document.getElementById("detail_img");img.src=itemlist[code].photo;let detail_name=document.querySelector(".detail_name");detail_name.innerHTML+=itemlist[code].name;let detail_price=document.querySelector(".detail_price");detail_price.innerHTML+=itemlist[code].price.toLocaleString("vi-VN",{style:"currency",currency:"VND"});let detail_brief=document.getElementById("detail_brief");detail_brief.innerHTML+=itemlist[code].brief;let detail_author=document.getElementById("detail_author");detail_author.innerHTML+=itemlist[code].author;let detail_infor=document.querySelector(".detail_infor");detail_infor.innerHTML+="<form id='"+code+"'  onsubmit='Addcart(this.id)'><div class='row'><label class='form-label col-2'>Số lượng:</label><input class='form-control col-5' type='number' id='add_amount' min='1' value='1'></div><input class='btn' type='submit' value='Thêm vào giỏ hàng'></form>"}let products_container=document.getElementById("products_container");if(products_container!=null){for(let key in itemlist){let product=itemlist[key];let div=document.createElement("div");div.setAttribute("class","product");let img=document.createElement("img");img.setAttribute("id",key);img.setAttribute("onclick","loadDetail(this.id)");img.src=product.photo;div.appendChild(img);let name=document.createElement("h3");name.setAttribute("id",key);name.setAttribute("onclick","loadDetail(this.id)");name.innerHTML=product.name;div.appendChild(name);let price=document.createElement("h4");price.innerHTML=product.price.toLocaleString("vi-VN",{style:"currency",currency:"VND"});div.appendChild(price);products_container.appendChild(div)}}function Lienhethanhcong(){let email=document.getElementById("email");let username=document.getElementById("username");let content=document.getElementById("content");let emailReg=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;if(email.value.length==0){alert("Vui lòng nhập email của bạn");return false}if(emailReg.test(email.value)==false){alert("Vui lòng nhập đúng email của bạn");return false}if(username.value.length==0){alert("Vui lòng nhập tên người dùng");return false}if(content.value.length==0){alert("Vui lòng nhập nội dung mà bạn cần liên hệ");return false}alert("Chúng tôi sẽ liên hệ lại với bạn trong thời gian sớm nhất");return true}